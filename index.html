<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Visualization with R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Jeremy Mack" />
    <script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
    <script src="libs/pymjs-1.3.2/pym.v1.js"></script>
    <script src="libs/widgetframe-binding-0.3.1/widgetframe.js"></script>
    <link rel="stylesheet" href="custom.css" type="text/css" />
    <link rel="stylesheet" href="default-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: center, middle, inverse, title-slide

## Data Visualization with R
#### Alex Pacheco and Jeremy Mack
#### April 17, 2020
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
### About this presentation

 * This course is the second in a series on R programming, with
   a focus on **data visualization**.
   
--
 
 * It is targeted at people that have experience progamming in R.
 
--
   
 * It could be useful for people who learned R some time ago and
   forgot it, or who are not familiar with modern R programming
   (`tidyverse`).
   
--
   
 * Slides from the first course, **Programming in R: a brief introduction**,
 can be found [here](&lt;https://jeremymack-lu.github.io/rprog/&gt;).
   
---
### Structure of the presentation

 * The presentation is split into four topics:

  + **Topic 1:** The (layered) Grammar of Graphics
 
  + **Topic 2:** Static visualizations
 
  + **Topic 3:** Dynamic visualizations
 
  + **Topic 4:** Shiny Apps

---
class: center, middle, inverse

#### Topic 1: The (layered) Grammar of Graphics
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* *The Grammar of Gaphics*

* Structure of data graphics.

* Foundation for modern applications.
  + **ggplot2**
  
  + Tableau
  
  + Vega-Lite]

.pull-right2[
&lt;center&gt;&lt;img src="./images/grammar.png" alt="RStudio" height=350/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot2a.png" alt="RStudio" height=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot2_1.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics
 + Required arguments
 
 + Sensible defaults
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics
 + Required arguments
 
 + Sensible defaults
 
* Basic template has three functions:
  + **ggplot** - creates a blank canvas
  
  + **geom** - adds a layer
  
  + **aes** - visual properties of an object
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

---
class: center, middle, inverse

#### Topic 2: Static visualizations
#### "Old Faithful"
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 2: Static visualizations
&lt;style&gt;
  pre {
    background-color: lightyellow;
    white-space: pre-wrap;
    line-height: 100%;
  }
&lt;/style&gt;

.pull-right2[
&lt;center&gt;&lt;img src="./images/OldFaithfulGeyser_Yellowstone.jpg" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny2.pull-left2[
* Old Faithful dataset:
  + Eruption time in minutes (*eruptions*)
  
  + Time until next eruption (*waiting*)
  {{content}}
]

--


```r
head(faithful, 5)
```

```
  eruptions waiting
1     3.600      79
2     1.800      54
3     3.333      74
4     2.283      62
5     4.533      85
```
{{content}}

--


```r
str(faithful)
```

```
'data.frame':	272 obs. of  2 variables:
 $ eruptions: num  3.6 1.8 3.33 2.28 4.53 ...
 $ waiting  : num  79 54 74 62 85 55 88 85 51 85 ...
```
{{content}}

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Create a blank ggplot canvas:

.tiny[

```r
ggplot(data=faithful)
```
]
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p1.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Create a blank ggplot canvas:
.tiny[

```r
ggplot(data=faithful)
```
]
* Add a geometric (geom) object layer and map variables to **aes**thetics:
.tiny[

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting))
```
]
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p3.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics
{{content}}
]

--

* Some things to remember:
 {{content}}

--

 + Multiple ways to map variables
   {{content}}

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Split mappings:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting))
```
{{content}}
]

--

* Mappings in **ggplot** function:

```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_point()
```
{{content}}

--

* Mappings in **geom** function:

```r
ggplot() +
geom_point(data=faithful,
           mapping=aes(
             x=eruptions,
             y=waiting))
```
{{content}}


---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + Multiple ways to map variables
   {{content}}

]

--

 + Multiple ways to change aesthetics
   {{content}}

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Mapping a color:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting,
             color=eruptions &lt; 3))
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p4.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations

.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Mapping a color:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting,
             color=eruptions &lt; 3))
```

* Setting a color:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue')
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + Multiple ways to map variables

 + Multiple ways to change aesthetics
   {{content}}

]

--

 + Order matters
 {{content}}

---
#### Topic 2: Static visualizations

.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Stacking layers:

```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_point() +
geom_smooth(method="lm")
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p7.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations

.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Stacking layers:

```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_point() +
geom_smooth(method="lm")
```


```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_smooth(method="lm") +
geom_point()
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p7b.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot2_2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + Multiple ways to map variables

 + Multiple ways to change aesthetics

 + Order matters
   {{content}} 

]

--

 + Many types of geoms, different mapping requirements
 {{content}}

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/geoms.png" height=550 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
class: center, middle, inverse

#### Topic 2: Static visualizations
#### ggplot2 extensions
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions

* Extends the grammar of graphics
{{content}}
]

--

 + Developed by R users
  {{content}}

--
  
 + Provides additional [functionality](&lt;http://exts.ggplot2.tidyverse.org/gallery/&gt;)
  {{content}}

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/patchwork_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions - **patchwork**

* Extends the grammar of graphics
{{content}}
]

--

 + Arranging multiple plots
  {{content}}

--
  
 + Many approaches
  {{content}}
     - Facets
     - gridExtra::grid.arrange()
     - ggpubr::ggarrange()
     - cowplot::plot_grid()
     - patchwork

---
#### Topic 2: Static visualizations
.tiny.left-column3[
* Establish plots:

```r
library(patchwork)

pw1 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point()

pw2 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point() +
  geom_smooth(method="lm")
```
]

--

.tiny.right-column3[
* Patchwork together:

```r
# Side by side
pw1 + pw2
```
{{content}}
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/pw1.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.tiny.left-column3[
* Establish plots:

```r
library(patchwork)

pw1 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point()

pw2 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point() +
  geom_smooth(method="lm")
```
]

.tiny.right-column3[
* Patchwork together:

```r
# Side by side
pw1 + pw2

# Stacked
pw1 / pw2
```
{{content}}
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/pw2.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.tiny.left-column3[
* Establish plots:

```r
library(patchwork)

pw1 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point()

pw2 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point() +
  geom_smooth(method="lm")

pw3 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_histogram()
```
]

.tiny.right-column3[
* Patchwork together:

```r
# Side by side
pw1 + pw2

# Stacked
pw1 / pw2

# Three figures
(pw1 + pw2) / pw3
```
{{content}}
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/pw3.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics
{{content}}
]

--

 + Provides extra geoms, scales, and themes
  {{content}}
  
---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics

 + Provides extra geoms, scales, and themes
 
 + Microsoft Excel theme

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue') +
theme_excel()
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5b.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics

 + Provides extra geoms, scales, and themes
 
 + Microsoft Excel theme
 
 + Wall Street Journal theme

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue') +
#theme_excel()
theme_wsj()
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5c.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics

 + Provides extra geoms, scales, and themes
 
 + Microsoft Excel theme
 
 + Wall Street Journal theme
 
 + Google Docs theme

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue') +
#theme_excel()
#theme_wsj()
theme_gdocs()
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5d.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
class: inverse

#### Review - static visualizations:
* Grammar of graphics - basis for many data visualization programs.

--

* **ggplot2** is a popular implementation.

 * Layered approach with sensible defaults.
 
 
   &lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=400/&gt;&lt;/center&gt;

--

* Extension packages expand **ggplot2** capabilities.

---
class: center, middle, inverse

#### Topic 3: Dynamic visualizations
#### "Life expectency"
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 3: Dynamic visualizations


* Life expectency (**gapminder**) dataset:

--

.tiny[  

```r
head(gapminder, 3)
```

```
# A tibble: 3 x 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.
2 Afghanistan Asia       1957    30.3  9240934      821.
3 Afghanistan Asia       1962    32.0 10267083      853.
```
]

--

.tiny[

```r
str(gapminder)
```

```
Classes 'tbl_df', 'tbl' and 'data.frame':	1704 obs. of  6 variables:
 $ country  : Factor w/ 142 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ continent: Factor w/ 5 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ lifeExp  : num  28.8 30.3 32 34 36.1 ...
 $ pop      : int  8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
 $ gdpPercap: num  779 821 853 836 740 ...
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/gapminder.gif" width=700 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/gganimate_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions - **gganimate**

* Extends the grammar of graphics
{{content}}
]

--

  + New grammar classes
  {{content}}

--
  
  + How a plot should change with time
  {{content}}

---
#### Topic 3: Dynamic visualizations
.tiny[

```r
# Use the gapminder dataset in ggplot
ggplot(data=gapminder,
       aes(x=gdpPercap, y=lifeExp, size=pop, color=country)) +
# Add a point geom
 geom_point(alpha=0.7, show.legend=FALSE)
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/p8a.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations
.tiny[

```r
# Use the gapminder dataset in ggplot
ggplot(data=gapminder,
       aes(x=gdpPercap, y=lifeExp, size=pop, color=country)) +
  # Add a point geom
 geom_point(alpha=0.7, show.legend=FALSE) +
```


```r
# Add some manual scaling and facets 
 scale_colour_manual(values=country_colors) +
 scale_size(range=c(2, 12)) +
 scale_x_log10() +
 facet_wrap(~continent, nrow=1)
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/p8b2.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations
.tiny[

```r
# Use the gapminder dataset in ggplot
ggplot(data=gapminder,
       aes(x=gdpPercap, y=lifeExp, size=pop, color=country)) +
# Add a point geom
 geom_point(alpha=0.7, show.legend=FALSE) +
```


```r
# Add some manual scaling and facets
 scale_colour_manual(values=country_colors) +
 scale_size(range=c(2, 12)) +
 scale_x_log10() +
 facet_wrap(~continent, nrow=1) +
```


```r
# Animate figure with gganimate package
 transition_time(year) +
 ease_aes('linear') +
 labs(title='Year: {frame_time}', 
      x='GDP per capita', 
      y='Life expectancy')
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/gapminder.gif" width=700 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/plotly_logo.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** integration - **plotly**

* Extends the grammar of graphics
{{content}}
]

--

  + Creates interactive web graphics
  {{content}}

--
  
  + Customizable user interface
  {{content}}

---
#### Topic 3: Dynamic visualizations
<div id="htmlwidget-80e798ddf12a3119e0f3" style="width:750px;height:500px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-80e798ddf12a3119e0f3">{"x":{"url":"index_files/figure-html//widgets/widget_unnamed-chunk-34.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>

---
#### Topic 3: Dynamic visualizations
.tiny[

```r
library(plotly)
plot &lt;- ggplot(data=gapminder, 
             aes(x=gdpPercap, y=lifeExp, size=pop, color=continent)) +
  # Add a point geom
  geom_point(alpha=0.7, show.legend=FALSE, aes(frame = year, ids = country)) +
  # Add some manual scaling
  scale_colour_manual(values=continent_colors) +
  scale_size(range=c(2, 12)) +
  scale_x_log10() +
  labs(x='GDP per capita', 
       y='Life expectancy at birth')
```
]

--

.tiny[

```r
fig &lt;- ggplotly(plot, height=500, width=750) %&gt;%
  animation_opts(
    1000, easing = "linear", redraw = FALSE) %&gt;%
  animation_slider(
    currentvalue=list(prefix="YEAR ",
                      font=list(color="red"),
                      xanchor='left',
                      yanchor='top')) %&gt;%
  animation_button(
    x = 1, xanchor = "right", y = -0.2, yanchor = "bottom"
  )
```
]

---
#### Topic 3: Dynamic visualizations
<div id="htmlwidget-58a28cd8e60d57afc19a" style="width:750px;height:500px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-58a28cd8e60d57afc19a">{"x":{"url":"index_files/figure-html//widgets/widget_unnamed-chunk-37.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>

---
class: inverse

#### Review - dynamic visualizations:
* Grammar of graphics - basis for many data visualization programs.

--

* **ggplot2** is a popular implementation.

 * Extention packages - **gganimate**.
 
 * Intergration packages - **ploltly**.

--

* Create visualizations that are dynamic and interactive.

---
class: center, middle, inverse

#### Topic 4: Shiny Apps
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 4: Shiny Apps
.right-column2[
&lt;center&gt;&lt;img src="./images/shiny_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* [RStudio](&lt;https://shiny.rstudio.com/&gt;) product - **shiny**

* Create interative web applications with R
{{content}}
]

--

* Three components:
{{content}}

--

 1. a user interface object (ui)
{{content}}
--

 2. a server function (server)
{{content}}
--

 3. a call to the **shinyApp** function
{{content}}

---
#### Topic 4: Shiny Apps

[&lt;center&gt;&lt;img src="./images/shiny_ui_8.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;](https://shiny.cc.lehigh.edu/jsm4/gapminder)

---
#### Topic 4: Shiny Apps
.right-column2[
&lt;center&gt;&lt;img src="./images/shiny_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* User interface object (ui)
{{content}}
]

--

* Determines how the application will look and function
{{content}}

--

* Three components: 
 {{content}}

--

 1. Layout
{{content}}


---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_1.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.right-column2[
&lt;center&gt;&lt;img src="./images/shiny_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* User interface object (ui)

* Determines how the application will look and function
 
* Three components:

 1. Layout
 
 2. User inputs
]

---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_2.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.right-column2[
&lt;center&gt;&lt;img src="./images/shiny_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* User interface object (ui)

* Determines how the application will look and function
 
* Three components:

 1. Layout
 
 2. User inputs
 
 3. Visible content
]
 
---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_3.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.right-column2[
&lt;center&gt;&lt;img src="./images/shiny_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* Server function (server)
{{content}}
]

--

* Creates *outputs* from *inputs* (i.e., reactive programming)
{{content}}

--
 
* Three parameters:
{{content}}

--

 1. Input
 {{content}}
 
--
 
 2. Output
 {{content}}
 
--
 
 3. Session
 {{content}}
 
---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_3.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.tiny[
* Load necessary packages:

```r
library(shiny)           # Shiny package   
library(gapminder)       # Dataset
library(tidyverse)       # Tidyverse, including ggplot and dplyr
library(shinydashboard)  # Shiny dashboard layout
library(plotly)          # Plotly package
```
]
---
#### Topic 4: Shiny Apps


.tiny[
* Define data:

```r
# Load gapminder data
df &lt;- gapminder
df &lt;- df %&gt;% as.data.frame()

# Create dataframe of country names 
df.countries &lt;- df %&gt;% select(country) %&gt;% unique()
head(df.countries)
```


```
       country
1  Afghanistan
13     Albania
25     Algeria
37      Angola
49   Argentina
61   Australia
```
]

---
#### Topic 4: Shiny Apps
.tiny2[
* Base Shiny app:

```r
ui &lt;- dashboardPage(
    dashboardHeader(),
    dashboardSidebar(),
    dashboardBody())

server &lt;- function(input, output, session){}

shinyApp(ui, server)
```
]

---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_4.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.tiny2[
* Define ui function:

```r
ui &lt;- dashboardPage(
    dashboardHeader(title="Gapminder Data"),
    dashboardSidebar(),
    dashboardBody()
)
```
]

---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_5.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.tiny2[
* Define ui function:

```r
ui &lt;- dashboardPage(
    dashboardHeader(title="Gapminder Data"),
    dashboardSidebar(
        varSelectizeInput(),
        selectizeInput(),
        selectizeInput()
  ),
    dashboardBody()
)
```
]

---
#### Topic 4: Shiny Apps
.tiny2[
* Define ui function:

```r
ui &lt;- dashboardPage(
    dashboardHeader(title="Gapminder Data"),
    dashboardSidebar(
        varSelectizeInput(inputId='variable',
                          label='Variable to plot:',
                          data=df[,4:6],
                          options=list(placeholder='Select variable',
                                       onInitialize=I('function() { this.setValue(""); }'))),
        selectizeInput(),
        selectizeInput(),
    dashboardBody()
)
```
]

---
#### Topic 4: Shiny Apps
.tiny2[
* Define ui function:

```r
ui &lt;- dashboardPage(
    dashboardHeader(title="Gapminder Data"),
    dashboardSidebar(
        varSelectizeInput(inputId='variable',
                          label='Variable to plot:',
                          data=df[,4:6],
                          options=list(placeholder='Select variable',
                                       onInitialize=I('function() { this.setValue(""); }'))),
        selectizeInput(inputId='country1',
                       label='Country 1 (red line):',
                       choices=df.countries,
                       options=list(placeholder='Select or type country',
                                    onInitialize=I('function() { this.setValue(""); }'))),
        selectizeInput(),
    dashboardBody()
)
```
]

---
#### Topic 4: Shiny Apps
.tiny2[
* Define ui function:

```r
ui &lt;- dashboardPage(
    dashboardHeader(title="Gapminder Data"),
    dashboardSidebar(
        varSelectizeInput(inputId='variable',
                          label='Variable to plot:',
                          data=df[,4:6],
                          options=list(placeholder='Select variable',
                                       onInitialize=I('function() { this.setValue(""); }'))),
        selectizeInput(inputId='country1',
                       label='Country 1 (red line):',
                       choices=df.countries,
                       options=list(placeholder='Select or type country',
                                    onInitialize=I('function() { this.setValue(""); }'))),
        selectizeInput(inputId='country2',
                       label='Country 2 (blue line):',
                       choices=df.countries,
                       options=list(placeholder='Select or type country',
                                    onInitialize=I('function() { this.setValue("United States"); }'))
                       )),
    dashboardBody()
)
```
]

---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_6.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.tiny2[
* Define ui function:

```r
ui &lt;- dashboardPage(
    dashboardHeader(title="Gapminder Data"),
    dashboardSidebar(
        varSelectizeInput(inputId='variable',
                          label='Variable to plot:',
                          data=df[,4:6],
                          options=list(placeholder='Select variable',
                                       onInitialize=I('function() { this.setValue(""); }'))),
        selectizeInput(inputId='country1',
                       label='Country 1 (red line):',
                       choices=df.countries,
                       options=list(placeholder='Select or type country',
                                    onInitialize=I('function() { this.setValue(""); }'))),
        selectizeInput(inputId='country2',
                       label='Country 2 (blue line):',
                       choices=df.countries,
                       options=list(placeholder='Select or type country',
                                    onInitialize=I('function() { this.setValue("United States"); }')))),
    dashboardBody(
            box(title="Country Comparison",
                solidHeader=TRUE,
                width=12,
                collapsible=TRUE,
                plotlyOutput('plot1')))
)
```
]

---
#### Topic 4: Shiny Apps

&lt;center&gt;&lt;img src="./images/shiny_ui_7.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 4: Shiny Apps
.tiny2[
* Define server function:

```r
server &lt;- function(input, output) {}
```
]

---
#### Topic 4: Shiny Apps
.tiny2[
* Define server function:

```r
server &lt;- function(input, output) {
    # Subset data based on Country 1 selection
    df.sub1 &lt;- reactive({
        req(input$country1)
        df %&gt;% filter(country==input$country1) %&gt;% select(year, !!input$variable)})
}
```
]

---
#### Topic 4: Shiny Apps
.tiny2[
* Define server function:

```r
server &lt;- function(input, output) {
    # Subset data based on Country 1 selection
    df.sub1 &lt;- reactive({
        req(input$country1)
        df %&gt;% filter(country==input$country1) %&gt;% select(year, !!input$variable)})
    # Subset data based on Country 2 selection
    df.sub2 &lt;- reactive({
        req(input$country2)
        df %&gt;% filter(country==input$country2) %&gt;% select(year, !!input$variable)})
}
```
]

---
#### Topic 4: Shiny Apps
.tiny2[
* Define server function:

```r
server &lt;- function(input, output) {
    # Subset data based on Country 1 selection
    df.sub1 &lt;- reactive({
        req(input$country1)
        df %&gt;% filter(country==input$country1) %&gt;% select(year, !!input$variable)})
    # Subset data based on Country 2 selection
    df.sub2 &lt;- reactive({
        req(input$country2)
        df %&gt;% filter(country==input$country2) %&gt;% select(year, !!input$variable)})
    # Plot variables
    output$plot1 &lt;- renderPlotly({
        df1   &lt;- df.sub1()
        df2   &lt;- df.sub2()
        plot1 &lt;- ggplot() + 
            geom_point(data=df1, color="darkred",
                       aes_string(x=names(df1)[1], y=names(df1)[2])) +
            geom_line(data=df1, color="darkred",
                      aes_string(x=names(df1)[1], y=names(df1)[2])) +
            geom_point(data=df2, color="darkblue",
                       aes_string(x=names(df2)[1], y=names(df2)[2])) +
            geom_line(data=df2, color="darkblue",
                      aes_string(x=names(df2)[1], y=names(df2)[2])) +
            labs(x = "Year", y = names(df1)[2]) +
            theme
        ggplotly(plot1)})
}
```
]

---
#### Topic 4: Shiny Apps

[&lt;center&gt;&lt;img src="./images/shiny_ui_8.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;](https://shiny.cc.lehigh.edu/jsm4/gapminder)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
