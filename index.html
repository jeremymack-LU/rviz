<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Visualization with R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Jeremy Mack" />
    <script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
    <script src="libs/pymjs-1.3.2/pym.v1.js"></script>
    <script src="libs/widgetframe-binding-0.3.1/widgetframe.js"></script>
    <link rel="stylesheet" href="custom.css" type="text/css" />
    <link rel="stylesheet" href="default-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: center, middle, inverse, title-slide

## Data Visualization with R
#### Jeremy Mack
#### Lehigh University - Digital Scholarship Team
&lt;img src="./images/notes2.png" alt="RStudio" height=242/&gt;

---
class: center, middle, inverse, title-slide

## Data Visualization with R
#### Jeremy Mack
#### Lehigh University - Digital Scholarship Team
&lt;img src="./images/gganimate_hex.png" alt="RStudio" height=150/&gt; &amp;nbsp; &lt;img src="./images/ggplot_hex.png" alt="RStudio" height=150/&gt; &amp;nbsp; &lt;img src="./images/patchwork_hex.png" alt="RStudio" height=150/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;

---
### About this presentation

 * This seminar is the second in a series on R programming, with
   a focus on **data visualization**.

--
 
 * It is targeted at people that have experience programming in R.
 
--
   
 * It could be useful for people who learned R some time ago and
   forgot it, or who are not familiar with modern R programming
   (`tidyverse`).
   
--
   
 * Slides are available on [Lehigh's Research Computing site](https://confluence.cc.lehigh.edu/display/hpc/Seminars), [Wordpress](https://wordpress.lehigh.edu/jsm4/r-at-lehigh/data-visualization-with-r/), and Github ([slides](https://jeremymack-lu.github.io/rviz/) and [raw code](https://github.com/jeremymack-LU/rviz))

---
### Structure of the presentation

The presentation is split into four topics:

 * [**Topic 1:**](https://jeremymack-lu.github.io/rviz/#12) The (layered) Grammar of Graphics
 
 * [**Topic 2:**](https://jeremymack-lu.github.io/rviz/#26) Static visualizations
 
 * [**Topic 3:**](https://jeremymack-lu.github.io/rviz/#102) Dynamic visualizations
 
 * [**Topic 4:**](https://jeremymack-lu.github.io/rviz/#133) Shiny Apps - a preview

---
#### Data Visualization with R

&lt;center&gt;&lt;img src="./images/data-science.png" alt="RStudio" height=350/&gt;&lt;/center&gt;

---
#### Data Visualization with R

&lt;center&gt;&lt;img src="./images/data-science2.png" alt="RStudio" height=350/&gt;&lt;/center&gt;

---
#### Data Visualization with R

&lt;center&gt;&lt;img src="./images/data-science3.png" alt="RStudio" height=350/&gt;&lt;/center&gt;

---
#### Data Visualization with R

&lt;center&gt;&lt;b&gt;“The simple graph has brought more information to the data analyst’s mind than any other device.” - John Tukey&lt;/b&gt;&lt;/center&gt;
&lt;br/&gt;
&lt;center&gt;&lt;img src="./images/dinosaur2.gif" alt="gif" height=200&lt;/&gt;&lt;/center&gt;

---
class: center, middle, inverse

#### Topic 1: The (layered) Grammar of Graphics
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* *The Grammar of Gaphics*

* Structure of data graphics.

* Foundation for modern applications.
  + **ggplot2**
  
  + Tableau
  
  + Vega-Lite]

.pull-right2[
&lt;center&gt;&lt;img src="./images/grammar.png" alt="RStudio" height=350/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot2a.png" alt="RStudio" height=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot1.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + Data creates the base (tidy format)
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot2.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + &lt;span style="color:lightgray"&gt;Data creates the base (tidy format)&lt;/span&gt;

 + Link variables to graphical properties
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot3.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + &lt;span style="color:lightgray"&gt;Data creates the base (tidy format)&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Link variables to graphical properties&lt;/span&gt;

 + Transform data to displayed values
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot4.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + &lt;span style="color:lightgray"&gt;Data creates the base (tidy format)&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Link variables to graphical properties&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Transform data to displayed values&lt;/span&gt;

 + Variable and property ranges
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot5.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + &lt;span style="color:lightgray"&gt;Data creates the base (tidy format)&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Link variables to graphical properties&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Transform data to displayed values&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Variable and property ranges&lt;/span&gt;

 + Graphical representation of the data
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot6.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + &lt;span style="color:lightgray"&gt;Data creates the base (tidy format)&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Link variables to graphical properties&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Transform data to displayed values&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Variable and property ranges&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Graphical representation of the data&lt;/span&gt;

 + Creates "small multiples"
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot7.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + &lt;span style="color:lightgray"&gt;Data creates the base (tidy format)&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Link variables to graphical properties&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Transform data to displayed values&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Variable and property ranges&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Graphical representation of the data&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Creates "small multiples"&lt;/span&gt;
 
 + Sets unique position
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot8.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + &lt;span style="color:lightgray"&gt;Data creates the base (tidy format)&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Link variables to graphical properties&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Transform data to displayed values&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Variable and property ranges&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Graphical representation of the data&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Creates "small multiples"&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Sets unique position&lt;/span&gt;
 
 + Defines the overall look of the plot
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot9.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics

 + Required arguments
 
 + Everything else has **sensible defaults**
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;]

---
#### Topic 1: The (layered) Grammar of Graphics
.pull-left2[
* Tidyverse - **ggplot2**

* Implementation of the grammar

* Layered approach to building graphics
 + Required arguments
 
 + Everything else has **sensible defaults**
 
* Basic template has three functions:
  + **ggplot** - creates a blank canvas
  
  + **geom** - adds a layer
  
  + **aes** - visual properties of an object
]

.pull-right2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

---
class: center, middle, inverse

#### Topic 2: Static visualizations
#### "Old Faithful"
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 2: Static visualizations

.pull-right2[
&lt;center&gt;&lt;img src="./images/OldFaithfulGeyser_Yellowstone.jpg" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny2.pull-left2[
* Old Faithful dataset:

  + Geyser in Yellowstone National Park
  
  + Eruption time in minutes (*eruptions*)
  
  + Time until next eruption (*waiting*)
  {{content}}
]

--


```r
head(faithful, 5)
```

```
  eruptions waiting
1     3.600      79
2     1.800      54
3     3.333      74
4     2.283      62
5     4.533      85
```
{{content}}


```r
str(faithful)
```

```
'data.frame':	272 obs. of  2 variables:
 $ eruptions: num  3.6 1.8 3.33 2.28 4.53 ...
 $ waiting  : num  79 54 74 62 85 55 88 85 51 85 ...
```
{{content}}

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Create a blank ggplot canvas:

.tiny[

```r
ggplot(data=faithful)
```
]
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p1.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Create a blank ggplot canvas:
.tiny[

```r
ggplot(data=faithful)
```
]
* Add a geometric (geom) object layer and map variables to **aes**thetics:
.tiny[

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting))
```
]
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p3.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + Multiple ways to map variables
]

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Split mappings:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting))
```
{{content}}
]

--

* Mappings in **ggplot** function:

```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_point()
```
{{content}}

--

* Mappings in **geom** function:

```r
ggplot() +
geom_point(data=faithful,
           mapping=aes(
             x=eruptions,
             y=waiting))
```
{{content}}

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Create a blank ggplot canvas:

```r
ggplot(data=faithful)
```

* Add a geometric (geom) object layer and map variables to **aes**thetics:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting))
```
{{content}}
]

--

* Add another **aes**thetic:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting,
             color=eruptions &lt; 3)))
```
{{content}}

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p4.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + &lt;span style="color:lightgray"&gt;Multiple ways to map variables&lt;/span&gt;

 + Multiple ways to change aesthetics
]

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Mapping a color:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting,
             color=eruptions &lt; 3))
```
{{content}}
]

--

* Setting a color:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue')
```
{{content}}

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + &lt;span style="color:lightgray"&gt;Multiple ways to map variables&lt;/span&gt;

 + &lt;span style="color:lightgray"&gt;Multiple ways to change aesthetics&lt;/span&gt;
 
 + Aesthetics vary by geometry
]

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Mapping a color:

```r
ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting,
             color=eruptions &lt; 3))
```
{{content}}
]

--

* Adding aesthetics:

```r
ggplot(data=faithful) +
    geom_point(mapping=aes(
        x=eruptions,
        y=waiting,
        color=eruptions &lt; 3,
        size=waiting),
        alpha=0.5)
```
{{content}}

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5e.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + &lt;span style="color:lightgray"&gt;Multiple ways to map variables&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Multiple ways to change aesthetics&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Aesthetics vary by geometry&lt;/span&gt;
 
 + When stacking layers, order matters
]

---
#### Topic 2: Static visualizations

.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Add another geom ("stacking layers"):

```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_point() +
geom_smooth(method="lm")
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p7.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations

.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny.left-column2[
* Add another geom ("stacking layers"):

```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_point() +
geom_smooth(method="lm")
```
{{content}}
]

--


```r
ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
geom_smooth(method="lm") +
geom_point()
```
{{content}}

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p7b.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + &lt;span style="color:lightgray"&gt;Multiple ways to map variables&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Multiple ways to change aesthetics&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Aesthetics vary by geometry&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;When stacking layers, order matters&lt;/span&gt;
 
 + Many types of geoms, different mapping requirements
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/geoms.png" height=550 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.left-column2[
* Layered approach to building graphics

* Some things to remember:

 + &lt;span style="color:lightgray"&gt;Multiple ways to map variables&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Multiple ways to change aesthetics&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Aesthetics vary by geometry&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;When stacking layers, order matters&lt;/span&gt;
 
 + &lt;span style="color:lightgray"&gt;Many types of geoms, different mapping requirements&lt;/span&gt;
 
 + Many (many!) theme arguments
]

---
#### Topic 2: Static visualizations

.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot10.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
&lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=500/&gt;&lt;/center&gt;
]

.tiny2.left-column2[
* Cleaning up the overall plot:

```r
plot &lt;- ggplot(data=faithful,
               mapping=aes(
                 x=eruptions,
                 y=waiting)) +
geom_smooth(method="lm") +
geom_point(size=0.25)
```
{{content}}
]

--


```r
plot &lt;- plot +
  theme(plot.background=element_blank(),
        panel.border=element_blank(),
        panel.background=element_blank(),
        axis.ticks=element_line(size=0.25),
        axis.text=element_text(size = 7),
        axis.line=element_line(size=0.25),
        axis.title=element_text(size = 7),
        legend.text=element_text(size = 7),
        legend.title=element_text(size = 7),
        legend.key=element_blank(),
        plot.title=element_text(hjust=.5, size=8)) +
    labs(title="Old Faithful Waiting Time",
         x="Length of eruption (minutes)",
         y="Waiting time to next eruption (minutes)")
```
{{content}}

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/faithful.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
class: center, middle, inverse

#### Topic 2: Static visualizations
#### ggplot2 extensions
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions

* Extends the grammar of graphics

 + Developed by R users
  
 + Provides additional [functionality](&lt;http://exts.ggplot2.tidyverse.org/gallery/&gt;)
]

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/patchwork_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions - **patchwork**

* Extends the grammar of graphics

 + Arranging multiple plots
  
 + Many approaches
     - Facets
     - gridExtra::grid.arrange()
     - ggpubr::ggarrange()
     - cowplot::plot_grid()
     - patchwork
]

---
#### Topic 2: Static visualizations
.tiny.left-column3[
* Establish plots:

```r
library(patchwork)

pw1 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point()

pw2 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point() +
  geom_smooth(method="lm")
```
]

--

.tiny.right-column3[
* Patchwork together:

```r
# Side by side
pw1 + pw2
```
{{content}}
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/pw1.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.tiny.left-column3[
* Establish plots:

```r
library(patchwork)

pw1 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point()

pw2 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point() +
  geom_smooth(method="lm")
```
]

.tiny.right-column3[
* Patchwork together:

```r
# Side by side
pw1 + pw2

# Stacked
pw1 / pw2
```
{{content}}
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/pw2.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.tiny.left-column3[
* Establish plots:

```r
library(patchwork)

pw1 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point()

pw2 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions,
         y=waiting)) +
  geom_point() +
  geom_smooth(method="lm")

pw3 &lt;- ggplot(data=faithful,
       mapping=aes(
         x=eruptions)) +
  geom_histogram()
```
]

.tiny.right-column3[
* Patchwork together:

```r
# Side by side
pw1 + pw2

# Stacked
pw1 / pw2

# Three figures
(pw1 + pw2) / pw3
```
{{content}}
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/pw3.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics

 + Provides extra geoms, scales, and themes
]
  
---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics

 + Provides extra geoms, scales, and themes
 
 + Microsoft Excel theme

```r
library(ggthemes)

ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue') +
theme_excel()
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5b.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics

 + Provides extra geoms, scales, and themes
 
 + Microsoft Excel theme
 
 + Wall Street Journal theme

```r
library(ggthemes)

ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue') +
#theme_excel()
theme_wsj()
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5c.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggforce_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny.left-column2[
* **ggplot2** extensions - **ggforce/ggthemes**

* Extends the grammar of graphics

 + Provides extra geoms, scales, and themes
 
 + Microsoft Excel theme
 
 + Wall Street Journal theme
 
 + Google Docs theme

```r
library(ggthemes)

ggplot(data=faithful) +
geom_point(mapping=aes(
             x=eruptions,
             y=waiting),
             color='blue') +
#theme_excel()
#theme_wsj()
theme_gdocs()
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/p5d.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
class: center, middle, inverse

#### Topic 2: Static visualizations
#### ggplot2 and simple features (sf) data
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/sf_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* Simple features (**sf**) data

* Introduces a new type of object to work with spatial data
{{content}}
]
  
---
#### Topic 2: Static visualizations
&lt;style&gt;
  pre {
    background-color: lightyellow;
    white-space: pre-wrap;
    line-height: 90%;
  }
&lt;/style&gt;
.right-column2[
&lt;center&gt;&lt;img src="./images/sf.jpg" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* Simple features (**sf**) data

* Introduces a new type of object to work with spatial data

 + Non-spatial data + Spatial data

 + Attributes + Geometries
]

---
class: center, middle, inverse

#### Comparison of sf and non-sf spatial data
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 2: Static visualizations
.right-column5[
* Spatial data in data frame


.tiny7[

```r
library(usmap) # State and county data non-sf
non_sf &lt;- us_map(regions="states"); head(non_sf, 5); str(non_sf)
```

```
##         x        y order  hole piece group fips abbr    full
## 1 1091779 -1380695     1 FALSE     1  01.1   01   AL Alabama
## 2 1091268 -1376372     2 FALSE     1  01.1   01   AL Alabama
## 3 1091140 -1362998     3 FALSE     1  01.1   01   AL Alabama
## 4 1090940 -1343517     4 FALSE     1  01.1   01   AL Alabama
## 5 1090913 -1341006     5 FALSE     1  01.1   01   AL Alabama
```

```
## 'data.frame':	12999 obs. of  9 variables:
##  $ x    : num  1091779 1091268 1091140 1090940 1090913 ...
##  $ y    : num  -1380695 -1376372 -1362998 -1343517 -1341006 ...
##  $ order: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ hole : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ piece: int  1 1 1 1 1 1 1 1 1 1 ...
##  $ group: chr  "01.1" "01.1" "01.1" "01.1" ...
##  $ fips : chr  "01" "01" "01" "01" ...
##  $ abbr : chr  "AL" "AL" "AL" "AL" ...
##  $ full : chr  "Alabama" "Alabama" "Alabama" "Alabama" ...
```
]
]

.left-column5[
* Spatial data in an sf object


.tiny7[

```r
library(urbnmapr) # State and county shapefiles in sf
states_sf &lt;- get_urbn_map("states", sf = TRUE); print(states_sf)
```

```
## Simple feature collection with 51 features and 3 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -2600000 ymin: -2363000 xmax: 2516374 ymax: 732352.2
## CRS:            EPSG:2163
## First 10 features:
##    state_fips state_abbv  state_name                       geometry
## 1          01         AL     Alabama MULTIPOLYGON (((1150023 -15...
## 2          04         AZ     Arizona MULTIPOLYGON (((-1386136 -1...
## 3          08         CO    Colorado MULTIPOLYGON (((-786661.9 -...
## 4          09         CT Connecticut MULTIPOLYGON (((2156197 -83...
## 5          12         FL     Florida MULTIPOLYGON (((1953691 -20...
## 6          13         GA     Georgia MULTIPOLYGON (((1308636 -10...
## 7          16         ID       Idaho MULTIPOLYGON (((-1357097 78...
## 8          18         IN     Indiana MULTIPOLYGON (((1042064 -71...
## 9          20         KS      Kansas MULTIPOLYGON (((-174904.2 -...
## 10         22         LA   Louisiana MULTIPOLYGON (((1075669 -15...
```
]
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/covid19b.jpeg" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations

.pull-right2[
&lt;center&gt;&lt;img src="./images/sf.jpg" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny2.pull-left2[
Necessary datasets:

 * Spatial data: state boundaries
  
 * Non-spatial data: cases of COVID-19
 
 * Non-spatial data: state populations
]

---
#### Topic 2: Static visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/map.jpeg" width=300 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* Spatial data: state boundaries


.tiny5[

```r
library(urbnmapr) # State and county shapefiles in sf
states.sf &lt;- get_urbn_map("states", sf = TRUE)
print(states.sf)
```

```
## Simple feature collection with 51 features and 3 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -2600000 ymin: -2363000 xmax: 2516374 ymax: 732352.2
## CRS:            EPSG:2163
## First 10 features:
##    state_fips state_abbv  state_name                       geometry
## 1          01         AL     Alabama MULTIPOLYGON (((1150023 -15...
## 2          04         AZ     Arizona MULTIPOLYGON (((-1386136 -1...
## 3          08         CO    Colorado MULTIPOLYGON (((-786661.9 -...
## 4          09         CT Connecticut MULTIPOLYGON (((2156197 -83...
## 5          12         FL     Florida MULTIPOLYGON (((1953691 -20...
## 6          13         GA     Georgia MULTIPOLYGON (((1308636 -10...
## 7          16         ID       Idaho MULTIPOLYGON (((-1357097 78...
## 8          18         IN     Indiana MULTIPOLYGON (((1042064 -71...
## 9          20         KS      Kansas MULTIPOLYGON (((-174904.2 -...
## 10         22         LA   Louisiana MULTIPOLYGON (((1075669 -15...
```
]
]

---
#### Topic 2: Static visualizations
.tiny5.left-column3[
* Non-spatial data: cases



```r
ts &lt;- "https://raw.githubusercontent.com/jeremymack-LU/rviz/master/data/us_covid_ts.csv"
ts &lt;- read_csv(ts)
head(ts)
```


```
## # A tibble: 6 x 5
##   state_name date       cases   new  new7
##   &lt;chr&gt;      &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Alabama    2020-01-22     0     0     0
## 2 Alabama    2020-01-23     0     0     0
## 3 Alabama    2020-01-24     0     0     0
## 4 Alabama    2020-01-25     0     0     0
## 5 Alabama    2020-01-26     0     0     0
## 6 Alabama    2020-01-27     0     0     0
```
]

.tiny5.right-column3[
* Non-spatial data: state populations



```r
pop &lt;- "https://raw.githubusercontent.com/jeremymack-LU/rviz/master/data/population.csv"
pop &lt;- read_csv(pop)
head(pop)
```


```
## # A tibble: 6 x 2
##   state      population
##   &lt;chr&gt;           &lt;dbl&gt;
## 1 Alabama       4903185
## 2 Alaska         731545
## 3 Arizona       7278717
## 4 Arkansas      3017804
## 5 California   39512223
## 6 Colorado      5758736
```


```r
names(pop)[1] &lt;- "state_name"
head(pop, 2)
```

```
## # A tibble: 2 x 2
##   state_name population
##   &lt;chr&gt;           &lt;dbl&gt;
## 1 Alabama       4903185
## 2 Alaska         731545
```

]

---
#### Topic 2: Static visualizations
.left-column2[
* Merge cases and population datasets
]
&lt;br/&gt;&lt;br/&gt;
.tiny5[

```r
# Combine data frames
df.us &lt;- ts %&gt;%
  group_by(state_name) %&gt;%
  arrange(date) %&gt;%
  # Select most recent date
  slice(n()) %&gt;%
  left_join(pop, by="state_name") %&gt;%
  # Calculate per capita rate
  mutate(new7b=round(new7/(population/100000),1))
head(df.us)
```

```
## # A tibble: 6 x 7
## # Groups:   state_name [6]
##   state_name date         cases   new  new7 population new7b
##   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 Alabama    2021-04-13  520503  1432  484.    4903185   9.9
## 2 Alaska     2021-04-13   65336   156  179.     731545  24.5
## 3 Arizona    2021-04-13  850846   610  767.    7278717  10.5
## 4 Arkansas   2021-04-13  332446   224  169.    3017804   5.6
## 5 California 2021-04-13 3706629  2559 3083.   39512223   7.8
## 6 Colorado   2021-04-13  481494  1904 1606.    5758736  27.9
```
]

---
#### Topic 2: Static visualizations
.left-column2[
* Merge attributes and geometries
]
&lt;br/&gt;&lt;br/&gt;
.tiny5[



```r
states.sf &lt;- states.sf %&gt;% 
  right_join(df.us, by="state_name")
head(states.sf)
```
]

.tiny5[

```
## Simple feature collection with 5 features and 9 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: -1389101 ymin: -2086803 xmax: 2295610 ymax: 67481.2
## CRS:            EPSG:2163
##   state_fips state_abbv  state_name       date   cases  new   new7 population
## 1         01         AL     Alabama 2021-04-13  520503 1432  484.1    4903185
## 2         04         AZ     Arizona 2021-04-13  850846  610  766.6    7278717
## 3         08         CO    Colorado 2021-04-13  481494 1904 1605.7    5758736
## 4         09         CT Connecticut 2021-04-13  325689 1118 1137.1    3565287
## 5         12         FL     Florida 2021-04-13 2134914 9068 6293.1   21477737
##   new7b                       geometry
## 1   9.9 MULTIPOLYGON (((1150023 -15...
## 2  10.5 MULTIPOLYGON (((-1386136 -1...
## 3  27.9 MULTIPOLYGON (((-786661.9 -...
## 4  31.9 MULTIPOLYGON (((2156197 -83...
## 5  29.3 MULTIPOLYGON (((1953691 -20...
```
]

---
#### Topic 2: Static visualizations

.pull-right2[
&lt;center&gt;&lt;img src="./images/sf.jpg" height=250 alt="RStudio" &lt;/center&gt;
]

.tiny2.pull-left2[
Necessary datasets:
 * Spatial data: state boundaries
  
 * Non-spatial data: cases of COVID-19
 
 * Non-spatial data: state populations
{{content}}
]

--

&lt;br/&gt;

Parts of the plot:
  
 * Map
 
 * Legend (custom)
  {{content}}

---
#### Topic 2: Static visualizations

.left-column2[
* Parts of the plot: Map
]
&lt;br/&gt;&lt;br/&gt;

.tiny2[

```r
# Create bins based on incidence value
states.sf &lt;- states.sf %&gt;%
  mutate(bin=cut(new7b,
                 breaks=c(0,0.9,9.5,24.5,1000),
                 labels=c("A","B","C","D")))
# Custom colors (Green, Yellow, Orange, and Red)
cols &lt;- c("A"="#197d7d", "B"="#dbc037", "C"="#e08f38", "D"="#8C1111")
# Create map
usa &lt;- ggplot() +
  geom_sf(data=states.sf, aes(fill=bin),
          size=0.25, color="white") +
  scale_fill_manual(values=cols) +
  theme_void() +
  theme(legend.position="none",
        text=element_text(color="#22211d"),
        plot.background=element_rect(fill="white", color=NA),
        panel.background=element_rect(fill="white", color=NA))
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/covid19c.jpeg" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations

.left-column8[
* Parts of the plot: Map - updated coordinate reference system (CRS)
]
&lt;br/&gt;&lt;br/&gt;

.tiny2[

```r
# Create map
usa2 &lt;- ggplot() +
  geom_sf(data=states.sf, aes(fill=bin),
          size=0.25, color="white") +
  scale_fill_manual(values=cols) +
# Update the coordinate reference system
  coord_sf(crs=st_crs(3857)) +
  theme_void() +
  theme(legend.position="none",
        text=element_text(color="#22211d"),
        plot.background=element_rect(fill="white", color=NA), 
        panel.background=element_rect(fill="white", color=NA))
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/covid19h.jpeg" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 2: Static visualizations
.left-column2[
* Parts of the plot: Legend (custom)
]
&lt;br/&gt;&lt;br/&gt;

.tiny2[

```r
# Create a legend item as another plot using annotate
leg.R &lt;- ggplot() +
  annotate(geom="rect", xmin=0, xmax=2, ymin=1.8, ymax=2, color=NA, fill="#8C1111") +
  annotate(geom="text", label="RED", x=1, y=1.9, color="white", size=3) +
  annotate(geom="text",
           label="Threshold:",
           x=0, hjust=0, y=1.75, vjust=1, size=2.5, fontface="bold") +
  annotate(geom="text",
           label="                    25+ daily\nnew cases per 100,000\npeople",
           x=0, hjust=0, y=1.75, vjust=1, size=2.5) +
  annotate(geom="text",
           label="Indicates:",
           x=0, hjust=0, y=1.3, vjust=1, size=2.5, fontface="bold") +
  annotate(geom="text",
           label="                  unchecked\ncommunity spread",
           x=0, hjust=0, y=1.3, vjust=1, size=2.5) +
  scale_y_continuous(limits=c(1,2)) +
  theme_void() +
  theme(text=element_text(color="#22211d"),
        plot.background=element_rect(fill="white", color=NA),
        panel.background=element_rect(fill="white", color=NA),
        legend.background=element_rect(fill="white", color=NA))
```
]

---
#### Topic 2: Static visualizations

&lt;img src="./images/covid19g.jpeg" alt="ggplot" height=175&lt;/&gt;
&lt;img src="./images/covid19f.jpeg" alt="ggplot" height=175&lt;/&gt;
&lt;img src="./images/covid19e.jpeg" alt="ggplot" height=175&lt;/&gt;
&lt;img src="./images/covid19d.jpeg" alt="ggplot" height=175&lt;/&gt;

---
#### Topic 2: Static visualizations

.left-column8[
* Combining parts of the plot using patchwork
]
&lt;br/&gt;&lt;br/&gt;

.tiny2[

```r
# Create a legend item as another plot using annotate
usa2 + (leg.G/leg.Y/leg.O/leg.R) + plot_layout(widths = c(4, 1)) + 
  plot_annotation(
    title='Which Places Have The Most New Daily Cases?',
    subtitle=paste("Data as of 11:59 p.m. ET", Sys.Date()-1)) &amp; 
  theme(plot.title=element_text(size= 12, hjust=0.5, color="#4e4d47",
                                margin=margin(b = -0.1, t = 0.4, l = 2, unit = "cm")),
        plot.subtitle=element_text(size=8, hjust=0.5, color="#4e4d47", face="italic",
                                   margin=margin(b = -0.1, t = 0.4, l = 2, unit = "cm")))
```
]

---
#### Topic 2: Static visualizations

&lt;center&gt;&lt;img src="./images/covid19b.jpeg" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
class: inverse

#### Review - Static visualizations:
* Grammar of graphics - basis for many data visualization programs.

--

* **ggplot2** is a popular implementation.

 * Layered approach with sensible defaults.
 
 
   &lt;center&gt;&lt;img src="./images/ggplot.png" alt="RStudio" width=400/&gt;&lt;/center&gt;

--

* Extension packages expand **ggplot2** capabilities.

--

* **sf** data makes working with spatial data more efficient.

---
class: center, middle, inverse

#### Topic 3: Dynamic visualizations
#### "Life expectency"
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 3: Dynamic visualizations
.pull-right2[
&lt;center&gt;&lt;img src="./images/gapminder2.png" alt="RStudio" width=250/&gt;&lt;/center&gt;
]

.tiny2.pull-left2[
* Life expectency (**gapminder**) dataset:

  + Data from the Gapminder foundation
  
  + Geography (*country* and *continent*)
  
  + Life expectency (*lifeExp*)
  
  + Economic data (*gdpPercap*)
  
  + Time (*year*)
]

---
#### Topic 3: Dynamic visualizations
.pull-right2[
&lt;center&gt;&lt;img src="./images/gapminder2.png" alt="RStudio" width=250/&gt;&lt;/center&gt;
]

.pull-left2[
* Life expectency (**gapminder**) dataset:

  + Data from the Gapminder foundation
  
  + Geography (*country* and *continent*)
  
  + Life expectency (*lifeExp*)
  
  + Economic data (*gdpPercap*)
  
  + Time (*year*)
]

&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

.tiny3[



```r
str(gapminder)
```

```
tibble [1,704 × 6] (S3: tbl_df/tbl/data.frame)
 $ country  : Factor w/ 142 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ continent: Factor w/ 5 levels "Africa","Americas",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ year     : int [1:1704] 1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ lifeExp  : num [1:1704] 28.8 30.3 32 34 36.1 ...
 $ pop      : int [1:1704] 8425333 9240934 10267083 11537966 13079460 14880372 12881816 13867957 16317921 22227415 ...
 $ gdpPercap: num [1:1704] 779 821 853 836 740 ...
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/gapminder.gif" width=700 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/gganimate_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** extensions - **gganimate**

* Extends the grammar of graphics
{{content}}
]

--

  + New grammar classes
  
  + How a plot should change with time
  {{content}}

---
#### Topic 3: Dynamic visualizations
.tiny[

```r
# Use the gapminder dataset in ggplot
ggplot(data=gapminder,
       aes(x=gdpPercap, y=lifeExp, size=pop, color=country)) +
# Add a point geom
 geom_point(alpha=0.7, show.legend=FALSE)
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/p8a.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations
.tiny[

```r
# Use the gapminder dataset in ggplot
ggplot(data=gapminder,
       aes(x=gdpPercap, y=lifeExp, size=pop, color=country)) +
  # Add a point geom
 geom_point(alpha=0.7, show.legend=FALSE) +
```


```r
# Add some manual scaling and facets 
 scale_colour_manual(values=country_colors) +
 scale_size(range=c(2, 12)) +
 scale_x_log10() +
 facet_wrap(~continent, nrow=1)
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/p8b2.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations
.tiny[

```r
# Use the gapminder dataset in ggplot
ggplot(data=gapminder,
       aes(x=gdpPercap, y=lifeExp, size=pop, color=country)) +
# Add a point geom
 geom_point(alpha=0.7, show.legend=FALSE) +
```


```r
# Add some manual scaling and facets
 scale_colour_manual(values=country_colors) +
 scale_size(range=c(2, 12)) +
 scale_x_log10() +
 facet_wrap(~continent, nrow=1) +
```


```r
# Animate figure with gganimate package
 transition_time(year) +
 ease_aes('linear') +
 labs(title='Year: {frame_time}', 
      x='GDP per capita', 
      y='Life expectancy')
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/gapminder.gif" width=700 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
class: center, middle, inverse

#### Topic 3: Dynamic visualizations
#### ggplot2 integrations
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 3: Dynamic visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/ggplot_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** integrations

* Integrate with ggplot2 objects

 + Used as required arguments

]

---
#### Topic 3: Dynamic visualizations
.right-column2[
&lt;center&gt;&lt;img src="./images/plotly_logo.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** integrations - **plotly**

* Extends the grammar of graphics

  + Creates interactive web graphics
  
  + Customizable user interface
]



---
#### Topic 3: Dynamic visualizations



.tiny2[
<div id="htmlwidget-16aadd849bec8a664b7c" style="width:750px;height:500px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-16aadd849bec8a664b7c">{"x":{"url":"index_files/figure-html//widgets/widget_unnamed-chunk-61.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
]

---
#### Topic 3: Dynamic visualizations
.tiny2[

```r
library(plotly)
plot &lt;- ggplot(data=gapminder, 
             aes(x=gdpPercap, y=lifeExp, size=pop, color=continent)) +
  # Add a point geom
  geom_point(alpha=0.7, show.legend=FALSE, aes(frame = year, ids = country)) +
  # Add some manual scaling
  scale_colour_manual(values=continent_colors) +
  scale_size(range=c(2, 12)) +
  scale_x_log10() +
  labs(x='GDP per capita', 
       y='Life expectancy at birth')
```
]

--

.tiny2[

```r
fig &lt;- ggplotly(plot, height=500, width=750) %&gt;%
  animation_opts(
    1000, easing = "linear", redraw = FALSE) %&gt;%
  animation_slider(
    currentvalue=list(prefix="YEAR ",
                      font=list(color="red"),
                      xanchor='left',
                      yanchor='top')) %&gt;%
  animation_button(
    x = 1, xanchor = "right", y = -0.2, yanchor = "bottom"
  )
```
]

---
#### Topic 3: Dynamic visualizations

<div id="htmlwidget-4f13fa5997625725631d" style="width:750px;height:500px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-4f13fa5997625725631d">{"x":{"url":"index_files/figure-html//widgets/widget_unnamed-chunk-64.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>

---
#### Topic 3: Dynamic visualizations

.right-column2[
&lt;center&gt;&lt;img src="./images/rayshader_hex.png" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* **ggplot2** integrations - **rayshader**

* Extends the grammar of graphics

  + Translates ggplot2 objects into 3D
  
  + Models can be rotated and examined interactively
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/test.png" width=700 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations

.tiny2[

```r
# Load necessary packages
pacman::p_load(tidyverse, raster, gggthemes, sp, sf, rasterVis, rayshader)
# Download raster dataset
url  &lt;- "https://github.com/jeremymack-LU/rviz/blob/master/data/CRLA_DEM_fill2.tif?raw=true"
download.file(url, "CRLA_DEM_fill2.tif")
# Load raster dataset and convert to a data frame
r    &lt;- raster("data/CRLA_DEM_fill2.tif")
r.df &lt;- as.data.frame(r, xy=TRUE)
# Create ggplot2 object
r.plot &lt;- ggplot() +
    geom_raster(data=r.df,
                aes(x=x, y=y, fill=CRLA_DEM_fill2),
                interpolate=TRUE,
                show.legend=FALSE) +
    scale_fill_gradientn(name = "Elevation", colors=terrain.colors(10)) +
    coord_quickmap() +
    theme_dark(base_size=6) +
    theme(axis.title=element_blank())
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/map.png" width=500 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations

.tiny2.left-column7[
* Create ggplot object


```r
# Load necessary packages
pacman::p_load(tidyverse, raster, gggthemes, sp, sf, rasterVis, rayshader)
# Download raster dataset
url  &lt;- "https://github.com/jeremymack-LU/rviz/blob/master/data/CRLA_DEM_fill2.tif?raw=true"
download.file(url, "CRLA_DEM_fill2.tif")
# Load raster dataset and convert to a data frame
r    &lt;- raster("data/CRLA_DEM_fill2.tif")
r.df &lt;- as.data.frame(r, xy=TRUE)
# Create ggplot2 object
r.plot &lt;- ggplot() +
    geom_raster(data=r.df,
                aes(x=x, y=y, fill=CRLA_DEM_fill2),
                interpolate=TRUE,
                show.legend=FALSE) +
    scale_fill_gradientn(name = "Elevation", colors=terrain.colors(10)) +
    coord_quickmap() +
    theme_dark(base_size=6) +
    theme(axis.title=element_blank())
```
]

--

.tiny2.right-column7[
* Pass to rayshader


```r
# Pass ggplot2 object to rayshader function
plot_gg(r.plot,
        multicore=TRUE,
        width=5,
        height=5,
        scale=250,
        windowsize=c(1400,866),
        zoom=0.55,
        phi=30)
# Capture snapshot of the rgl window
render_snapshot(filename = "CRLA_3D",
                clear=TRUE)
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/CRLA_3D_no_water.png" width=500 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
#### Topic 3: Dynamic visualizations

.tiny2.left-column7[
* Create ggplot object

```r
# Load viridis package
library(viridis)
# Plot using mtcars dataset
gg_cars &lt;- ggplot(mtcars) + 
    geom_point(aes(x=disp, color=wt, y=mpg), size=2) +
    scale_fill_viridis("Weight") +
    ggtitle("mtcars: Displacement vs mpg vs # of cylinders") +
    theme_dark() +
    theme(title = element_text(size=8),
          text = element_text(size=12),
          legend.position = 'bottom') 
```
]

.tiny2.right-column7[
* Pass to rayshader

```r
# Pass ggplot2 object to rayshader function
plot_gg(gg_cars,
        multicore=TRUE,
        width=6,
        height=5,
        scale=250,
        windowsize=c(1400,866),
        zoom=0.55,
        phi=30)
# Capture snapshot of the rgl window
render_snapshot(filename = "mtcars",
                clear=TRUE)
```
]

---
#### Topic 3: Dynamic visualizations

&lt;center&gt;&lt;img src="./images/mtcars.png" width=500 alt="ggplot"&lt;/&gt;&lt;/center&gt;

---
class: inverse

#### Review - Dynamic visualizations:
* Dynamic visualization created with **ggplot2** extensions and integrations

--

* **gganimate** is a popular extension for animating graphs

 * Adds new grammar to ggplot2

--

* **rayshader** is a popular integration for creating 3D objects

  * Uses ggplot objects as required arguments
&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;
.pull-right[
&lt;center&gt;&lt;img src="./images/rayshader.png" width=400 alt="ggplot"&lt;/&gt;&lt;/center&gt;
]

---
class: center, middle, inverse

#### Topic 4: Shiny Apps - a preview
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;br/&gt;&lt;br/&gt;

---
#### Topic 4: Shiny Apps - a preview
.right-column2[
&lt;center&gt;&lt;img src="./images/shiny_hex.png" height=250 alt="RStudio" &lt;/center&gt;
&lt;br/&gt;&lt;br/&gt;
&lt;center&gt;&lt;img src="./images/master_shiny.jpg" height=250 alt="RStudio" &lt;/center&gt;
]

.left-column2[
* [RStudio](&lt;https://shiny.rstudio.com/&gt;) product - **shiny**

* Build interactive web applications, reports, and dashboards with R

* Reactive Programming
]

---
#### Topic 4: Shiny Apps - a preview

[&lt;center&gt;&lt;img src="./images/covid_shiny.png" alt="ggplot"&lt;/&gt;&lt;/center&gt;](https://shiny.cc.lehigh.edu/jsm4/covid19)

---
class: inverse

#### Review - Data Visualization Resources:
* RStudio (and user contributed) cheatsheets - [link](https://rstudio.com/resources/cheatsheets/)

--

* Data visualization (**ggplot**)

 * *R for Data Science* by Hadley Wickham and Garret Grolemund - [link](https://r4ds.had.co.nz/index.html)
 
--
 
 * Thomas Lin Pedersen ggplot2 presentation (YouTube), Part 1 - [link](https://www.youtube.com/watch?v=h29g21z0a68)
 
 * Thomas Lin Pedersen ggplot2 presentation (YouTube), Part 2 - [link](https://www.youtube.com/watch?v=0m4yywqNPVY)
 
--

* Shiny Apps

 * *Mastering Shiny* by Hadley Wickham - [link](https://mastering-shiny.org)
 
 * RStudio tutortials - [link](https://shiny.rstudio.com/tutorial/)
 
---
class: center, middle, inverse, title-slide

## Questions?
&lt;img src="./images/contact.png" alt="RStudio" height=400/&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
